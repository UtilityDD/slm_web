import{r as c,s as _,j as e,g as S,R as ze}from"./index-BvyGtfEM.js";import{c as g}from"./cacheHelper-BlUM2QW1.js";function Pe({language:n="bn",user:i,setCurrentView:T,isFullLeaderboard:O=!1,userProfile:d,refreshProfile:oe}){var Se,Le,Ce,$e;const[$,ie]=c.useState(!0),[f,M]=c.useState(null),[u,K]=c.useState([]),[k,R]=c.useState(0),[w,V]=c.useState({}),[Ee,W]=c.useState(!1),[Je,G]=c.useState(0),[v,Me]=c.useState(null),[z,ce]=c.useState([]),[h,xe]=c.useState(null),[Ke,qe]=c.useState(""),[me,F]=c.useState(null),[H,q]=c.useState(0),[L,be]=c.useState(!1),[p,he]=c.useState(null),[pe,ue]=c.useState([]),[ge,X]=c.useState(O),[fe,Z]=c.useState(0),[P,B]=c.useState(!1),[je,Ve]=c.useState(!O),[Ae,De]=c.useState(new Set),[A,ve]=c.useState(navigator.onLine),[ee,D]=c.useState(!1),[j,N]=c.useState(null),[C,U]=c.useState(null),[Ge,Ie]=c.useState(0),[te,I]=c.useState(null),se=()=>new Date(Date.now()+fe),m={en:{title:"Competitions",weekly:"Weekly Challenge",hourly:"Hourly Quiz",play:"Play Now",questions:"Questions",mins:"Mins",points:"Pts",leaderboard:"Leaderboard",completed:"Quiz Completed!",score:"Your Score",close:"Close",loginReq:"Please login to participate",highStakes:"High Stakes Mode Active",highStakesDesc:"Wrong answers deduct 5 points",syncing:"Syncing your score...",waitingNetwork:"Waiting for network connection...",autoRetry:"Auto-retry enabled",previousPending:"Previous attempt pending sync",retryNow:"Retry Now",syncSuccess:"Score synced successfully!",syncFailed:"Sync failed. Please retry."},bn:{title:"à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾",weekly:"à¦¸à¦¾à¦ªà§à¦¤à¦¾à¦¹à¦¿à¦• à¦šà§à¦¯à¦¾à¦²à§‡à¦žà§à¦œ",hourly:"à¦˜à¦¨à§à¦Ÿà¦¾à¦­à¦¿à¦¤à§à¦¤à¦¿à¦• à¦•à§à¦‡à¦œ",play:"à¦–à§‡à¦²à§à¦¨",questions:"à¦ªà§à¦°à¦¶à§à¦¨",mins:"à¦®à¦¿à¦¨à¦¿à¦Ÿ",points:"à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ",leaderboard:"à¦²à¦¿à¦¡à¦¾à¦°à¦¬à§‹à¦°à§à¦¡",completed:"à¦•à§à¦‡à¦œ à¦¸à¦®à§à¦ªà¦¨à§à¦¨!",score:"à¦†à¦ªà¦¨à¦¾à¦° à¦¸à§à¦•à§‹à¦°",close:"à¦¬à¦¨à§à¦§ à¦•à¦°à§à¦¨",loginReq:"à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦•à¦°à¦¤à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨",highStakes:"à¦¹à¦¾à¦‡ à¦¸à§à¦Ÿà§‡à¦• à¦®à§‹à¦¡ à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼",highStakesDesc:"à¦­à§à¦² à¦‰à¦¤à§à¦¤à¦°à§‡à¦° à¦œà¦¨à§à¦¯ à§« à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦•à¦¾à¦Ÿà¦¾ à¦¹à¦¬à§‡",syncing:"à¦†à¦ªà¦¨à¦¾à¦° à¦¸à§à¦•à§‹à¦° à¦¸à¦¿à¦™à§à¦• à¦¹à¦šà§à¦›à§‡...",waitingNetwork:"à¦¨à§‡à¦Ÿà¦“à¦¯à¦¼à¦¾à¦°à§à¦• à¦¸à¦‚à¦¯à§‹à¦—à§‡à¦° à¦œà¦¨à§à¦¯ à¦…à¦ªà§‡à¦•à§à¦·à¦¾ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡...",autoRetry:"à¦¸à§à¦¬à¦¯à¦¼à¦‚à¦•à§à¦°à¦¿à¦¯à¦¼ à¦ªà§à¦¨à¦ƒà¦šà§‡à¦·à§à¦Ÿà¦¾ à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼",previousPending:"à¦ªà§‚à¦°à§à¦¬à¦¬à¦°à§à¦¤à§€ à¦ªà§à¦°à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦¸à¦¿à¦™à§à¦•à§‡à¦° à¦œà¦¨à§à¦¯ à¦…à¦ªà§‡à¦•à§à¦·à¦®à¦¾à¦£",retryNow:"à¦à¦–à¦¨à¦‡ à¦ªà§à¦¨à¦ƒà¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨",syncSuccess:"à¦¸à§à¦•à§‹à¦° à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦¸à¦¿à¦™à§à¦• à¦¹à¦¯à¦¼à§‡à¦›à§‡!",syncFailed:"à¦¸à¦¿à¦™à§à¦• à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦…à¦¨à§à¦—à§à¦°à¦¹ à¦•à¦°à§‡ à¦ªà§à¦¨à¦ƒà¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨à¥¤"}}[n],re=async()=>{ie(!0),B(!1);try{const t=[We()];O?t.push(He()):t.push(Fe()),i&&t.push(Y()),await Promise.all(t)}catch(t){console.error("Error loading competition data:",t)}finally{ie(!1)}};c.useEffect(()=>{re()},[n,i]),c.useEffect(()=>{const t=()=>{const a=se(),r=59-a.getMinutes(),l=59-a.getSeconds();qe(`${r}:${l<10?"0":""}${l}`)};t();const s=setInterval(t,1e3);return()=>clearInterval(s)},[fe]);const ae=()=>{ve(!0),console.log("Network restored"),(!h||P)&&re(),ne()},le=()=>{ve(!1),console.log("Network offline")};c.useEffect(()=>{window.addEventListener("online",ae),window.addEventListener("offline",le),Qe();const t=setInterval(()=>{!navigator.onLine&&A?le():navigator.onLine&&!A&&ae()},3e4);return()=>{window.removeEventListener("online",ae),window.removeEventListener("offline",le),clearInterval(t)}},[A,h,P]);const Qe=()=>{try{const t=localStorage.getItem("pending_quiz_submissions");if(t){const s=JSON.parse(t);s&&s.length>0&&(U(s[0]),navigator.onLine&&ne())}}catch(t){console.error("Error checking pending submissions:",t)}},Te=t=>{try{const s=localStorage.getItem("pending_quiz_submissions"),a=s?JSON.parse(s):[];a.some(l=>l.quiz_id===t.quiz_id&&l.timestamp===t.timestamp)||(a.push(t),localStorage.setItem("pending_quiz_submissions",JSON.stringify(a)),U(t),console.log("Saved pending submission:",t))}catch(s){console.error("Error saving pending submission:",s)}},ne=async()=>{try{const t=localStorage.getItem("pending_quiz_submissions");if(!t)return;const s=JSON.parse(t);if(s.length===0)return;D(!0),N("syncing");for(let a=0;a<s.length;a++){const r=s[a];await Oe(r,a)}}catch(t){console.error("Error processing pending queue:",t),N("failed"),I(t.message||"Queue processing failed")}finally{D(!1)}},ke=async(t,s,a=0)=>{var l,x,b;const r=await _.rpc("submit_quiz_result",{p_quiz_id:t,p_score:s,p_penalty:a});return r.error&&((l=r.error.message)!=null&&l.includes("parameter")||(x=r.error.message)!=null&&x.includes("function")||(b=r.error.message)!=null&&b.includes("signature")||r.error.code==="P0000")?(console.warn("New submit_quiz_result signature not found or failed, falling back to old signature."),await _.rpc("submit_quiz_result",{p_quiz_id:t,p_score:s})):(r.error&&console.error("submit_quiz_result RPC Error:",r.error),r)},Oe=async(t,s=0)=>{try{console.log(`Retrying submission ${s+1}:`,t),N("syncing");const{error:a}=await ke(t.quiz_id,t.score,t.penalty||0);if(a)if(a.code==="23505")console.log("Submission already exists in database (23505), treating as success.");else throw a;if(await Re(t),N("success"),I(null),t.penalty&&q(t.penalty),await Y(!0),t.quiz_id===(h==null?void 0:h.id)){F(t.timestamp);const r=`last_attempt_${i.id}_${t.quiz_id}`;g.set(r,t.timestamp,5)}console.log("Successfully synced submission:",t)}catch(a){throw console.error("Retry failed:",a),N("failed"),I(a.message||"Unknown error"),Ie(r=>r+1),a}},Re=async t=>{try{const s=localStorage.getItem("pending_quiz_submissions");if(!s)return;const r=JSON.parse(s).filter(l=>!(l.quiz_id===t.quiz_id&&l.timestamp===t.timestamp));r.length>0?(localStorage.setItem("pending_quiz_submissions",JSON.stringify(r)),U(r[0]||null)):(localStorage.removeItem("pending_quiz_submissions"),U(null))}catch(s){console.error("Error clearing pending submission:",s)}},We=async()=>{const t=g.get("server_time_offset");if(t!==null){Z(t);return}try{const{data:s,error:a}=await _.rpc("get_server_time");if(s){const r=new Date(s).getTime(),l=Date.now(),x=r-l;Z(x),g.set("server_time_offset",x,30)}else{const r=await fetch("https://worldtimeapi.org/api/timezone/Etc/UTC");if(r.ok){const l=await r.json(),x=new Date(l.datetime).getTime(),b=Date.now(),o=x-b;Z(o),g.set("server_time_offset",o,30)}}}catch(s){console.error("Error fetching server time:",s)}},Fe=async()=>{const t=se(),a=`hourly_quiz_db_bn_${`${t.getFullYear()}${t.getMonth()+1}${t.getDate()}${t.getHours()}`}`,r=g.get(a);if(r){xe(r);return}try{const{data:l,error:x}=await _.rpc("get_random_hourly_questions",{lang:"bn",limit_count:5});if(x){console.error("Error fetching hourly quiz from DB:",x),B(!0);return}if(l&&l.length>0){const b={id:"hourly-challenge",title:n==="en"?"Hourly Safety Challenge":"à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦¨à§à¦Ÿà¦¾à¦¯à¦¼ à¦¸à§à¦°à¦•à§à¦·à¦¾ à¦šà§à¦¯à¦¾à¦²à§‡à¦žà§à¦œ",description:n==="en"?"Test your safety knowledge! New questions every hour.":"à¦†à¦ªà¦¨à¦¾à¦° à¦¸à§à¦°à¦•à§à¦·à¦¾ à¦œà§à¦žà¦¾à¦¨ à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à§à¦¨! à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦¨à§à¦Ÿà¦¾à¦¯à¦¼ à¦¨à¦¤à§à¦¨ à¦ªà§à¦°à¦¶à§à¦¨à¥¤",duration_minutes:5,points_reward:50,questions:l.map((o,y)=>({id:o.id,question_text:o.question_text,options:o.options,correct_option_index:o.correct_answer_index,category:o.category,tags:o.tags})),isLocal:!1};xe(b),g.set(a,b,60)}else console.warn("No questions returned from DB")}catch(l){console.error("Unexpected error fetching hourly quiz:",l),B(!0)}},we=async t=>{if(!i)return;try{const r=localStorage.getItem(`review_${t}`);if(r){const l=JSON.parse(r);l.penalty!==void 0&&q(l.penalty)}}catch(r){console.error("Error reading local penalty:",r)}const s=`last_attempt_${i.id}_${t}`,a=g.get(s);if(a&&a.time){F(a.time),q(a.penalty||0);return}try{const{data:r,error:l}=await _.from("quiz_attempts").select("created_at, penalty").eq("user_id",i.id).eq("quiz_id",t).order("created_at",{ascending:!1}).limit(1);r&&r.length>0&&(F(r[0].created_at),q(r[0].penalty||0),g.set(s,{time:r[0].created_at,penalty:r[0].penalty||0},5))}catch(r){console.error("Error fetching last attempt:",r)}};c.useEffect(()=>{i&&h&&we(h.id)},[i,h]);const de=async(t=!1)=>{if(!i)return;const s=`user_rank_${i.id}`;if(!t){const a=g.get(s);if(a){he(a);return}}try{const{data:a,error:r}=await _.from("leaderboard_view").select("score").eq("user_id",i.id).single();if(r||!a)return;const{count:l,error:x}=await _.from("leaderboard_view").select("*",{count:"exact",head:!0}).gt("score",a.score);if(!x){const b={rank:l+1,score:a.score};he(b),g.set(s,b,5)}}catch(a){console.error("Error fetching rank:",a)}},Y=async(t=!1)=>{if(!t){const s=g.get("leaderboard_top_10_v3");if(s){ce(s),i&&de();return}}try{const{data:s,error:a}=await _.from("leaderboard_view").select("*").order("score",{ascending:!1}).limit(10);if(a)throw a;const r=s.map(l=>({...l,points:l.score}));ce(r||[]),g.set("leaderboard_top_10_v3",r||[],5),i&&de(t)}catch(s){console.error("Error fetching leaderboard:",s),B(!0)}},He=async()=>{X(!0);const t=g.get("leaderboard_full_v3");if(t){ue(t),X(!1);return}try{const{data:s,error:a}=await _.from("leaderboard_view").select("*").order("score",{ascending:!1}).limit(50);if(a)throw a;const r=s.map(l=>({...l,points:l.score}));ue(r||[]),g.set("leaderboard_full_v3",r||[],5)}catch(s){console.error("Error fetching full leaderboard:",s)}finally{X(!1)}},Ne=()=>{typeof T=="function"&&T("leaderboard")},ye=async t=>{if(!i){T("login");return}if(C&&C.quiz_id===t.id){alert(m.previousPending+". "+(A?m.retryNow:m.waitingNetwork));return}if(M(t),t.questions&&t.questions.length>0){const a=[...t.questions].sort(()=>.5-Math.random()).slice(0,5).map(r=>{if(!r.options||r.options.length===0)return r;const l=r.options[r.correct_option_index],x=[...r.options].sort(()=>.5-Math.random()),b=x.indexOf(l);return{...r,options:x,correct_option_index:b!==-1?b:r.correct_option_index}});K(a)}else K([]);R(0),V({}),W(!1),G(0),be(!1)},_e=()=>{const t=localStorage.getItem(`review_${h.id}`);if(!t)return;const s=JSON.parse(t);M(h),K(s.questions),V(s.answers),G(s.score),be(!0),W(!1),R(0)},Be=(t,s)=>{V(a=>({...a,[t]:s}))},Ue=async()=>{let t=0,s=0;u.forEach(o=>{w[o.id]===o.correct_option_index&&s++});const r=((d==null?void 0:d.points)||(p==null?void 0:p.score)||0)>1e3;let l=0,x=10;f&&f.points_reward&&u.length>0&&(x=Math.floor(f.points_reward/u.length)),u.length>0&&(t=s*x,r&&(l=u.filter(y=>w[y.id]!==void 0&&w[y.id]!==y.correct_option_index).length*5,t-=l)),G(t),Me({correct:s,wrong:u.filter(o=>w[o.id]!==void 0&&w[o.id]!==o.correct_option_index).length,skipped:u.filter(o=>w[o.id]===void 0).length,penalty:l,score:t,pointsEarned:s*x}),W(!0);const b={timestamp:new Date().toISOString(),questions:u,answers:w,score:t,penalty:l};if(localStorage.setItem(`review_${f.id}`,JSON.stringify(b)),f&&f.id===(h==null?void 0:h.id)){F(b.timestamp);const o=`last_attempt_${i.id}_${f.id}`;g.set(o,b.timestamp,5)}D(!0),N("syncing");try{const{error:o}=await ke(f.id||"unknown_quiz",t,l);if(o)throw o;N("success"),I(null),D(!1),q(l),await Y(!0),await de(!0),oe&&await oe(i),f&&f.id&&(g.clear(`last_attempt_${i.id}_${f.id}`),we(f.id))}catch(o){console.error("Error saving result:",o),D(!1);const y={quiz_id:f.id||"unknown_quiz",user_id:i.id,score:t,penalty:l,timestamp:b.timestamp,questions:u,answers:w,retry_count:0};Te(y),navigator.onLine?(N("failed"),I(o.message||"Sync failed")):(N("waiting"),alert(m.waitingNetwork+" "+m.autoRetry))}};return O?e.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-white/80 dark:bg-slate-800/80 backdrop-blur-xl border-b border-slate-200/50 dark:border-slate-700/50",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 dark:text-slate-50",children:["ðŸ† ",n==="en"?"Global Leaderboard":"à¦—à§à¦²à§‹à¦¬à¦¾à¦² à¦²à¦¿à¦¡à¦¾à¦°à¦¬à§‹à¦°à§à¦¡"]}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 dark:text-slate-400 mt-1",children:n==="en"?"Top performers across all regions":"à¦¸à¦•à¦² à¦…à¦žà§à¦šà¦²à§‡ à¦¶à§€à¦°à§à¦· à¦ªà¦¾à¦°à¦«à¦°à¦®à¦¾à¦°à¦°à¦¾"})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800/50",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:n==="en"?"Live":"à¦²à¦¾à¦‡à¦­"})]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 space-y-4",children:[i&&p&&!ge&&(()=>{var s;const t=S((d==null?void 0:d.training_level)||0);return e.jsx("div",{className:"bg-white dark:bg-slate-800/80 rounded-xl border border-slate-200 dark:border-slate-700 shadow-md p-3 sm:p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:n==="en"?"Your Standing":"à¦†à¦ªà¦¨à¦¾à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("p",{className:"text-xl sm:text-2xl font-black text-slate-900 dark:text-white",children:["#",p.rank]}),t&&e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-md text-[10px] font-bold border shadow-sm ${t.color}`,children:n==="en"?t.en:t.bn}),e.jsxs("p",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 ml-1",children:[p.score.toLocaleString()," pts"]})]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center font-bold text-blue-600 dark:text-blue-300 border border-slate-200 dark:border-slate-600 overflow-hidden shrink-0",children:d!=null&&d.avatar_url?e.jsx("img",{src:d.avatar_url,alt:"Avatar",className:"w-full h-full object-cover"}):((s=d==null?void 0:d.full_name)==null?void 0:s[0])||"U"})]})})})(),e.jsx("div",{className:"bg-white dark:bg-slate-800/50 rounded-2xl border border-slate-200/50 dark:border-slate-700/50 overflow-hidden shadow-lg shadow-slate-200/20 dark:shadow-none mb-8",children:e.jsx("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 240px)"},children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-slate-50 dark:bg-slate-700/50 border-b border-slate-200 dark:border-slate-700 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-4 py-2 text-left text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-10",children:n==="en"?"Rank":"à¦°â€à§à¦¯à¦¾à¦™à§à¦•"}),e.jsx("th",{className:"px-3 sm:px-4 py-2 text-left text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:n==="en"?"Player":"à¦–à§‡à¦²à§‹à¦¯à¦¼à¦¾à¦¡à¦¼"}),e.jsx("th",{className:"hidden sm:table-cell px-3 sm:px-4 py-2 text-left text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:n==="en"?"Level":"à¦¸à§à¦¤à¦°"}),e.jsx("th",{className:"px-3 sm:px-4 py-2 text-right text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:n==="en"?"Points":"à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700/30",children:ge?Array(12).fill(0).map((t,s)=>e.jsx("tr",{className:"h-14",children:e.jsx("td",{colSpan:"5",className:"px-4 sm:px-6 py-3",children:e.jsx(E,{})})},s)):pe.length>0?pe.map((t,s)=>{var o,y;const a=t.user_id===(i==null?void 0:i.id),r=S(t.training_level),l=Q=>Q===1?"ðŸ¥‡":Q===2?"ðŸ¥ˆ":Q===3?"ðŸ¥‰":null,x=Ae.has(t.user_id),b=()=>{De(Q=>{const J=new Set(Q);return J.has(t.user_id)?J.delete(t.user_id):J.add(t.user_id),J})};return e.jsxs(ze.Fragment,{children:[e.jsxs("tr",{onClick:b,className:`transition-colors border-b border-slate-50 dark:border-slate-700/50 cursor-pointer ${a?"bg-blue-50/50 dark:bg-blue-900/10":"hover:bg-slate-50/30 dark:hover:bg-slate-700/10"}`,children:[e.jsx("td",{className:"px-3 sm:px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[l(s+1)&&e.jsx("span",{className:"text-sm",children:l(s+1)}),e.jsxs("span",{className:`font-bold ${s<3?"text-blue-600":"text-slate-400"}`,children:["#",s+1]})]})}),e.jsx("td",{className:"px-3 sm:px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-slate-200 dark:bg-slate-700 flex-shrink-0 overflow-hidden border border-slate-300/50 dark:border-slate-600/50 shadow-sm",children:t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400 font-bold text-[10px] uppercase",children:((o=t.full_name)==null?void 0:o[0])||"?"})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[e.jsx("p",{className:`text-xs font-bold truncate ${a?"text-blue-700 dark:text-blue-400":"text-slate-800 dark:text-slate-200"}`,children:a?n==="en"?"You":"à¦†à¦ªà¦¨à¦¿":t.full_name||"Anonymous"}),r&&e.jsx("span",{className:`sm:hidden inline-flex px-1.5 py-0.5 rounded text-[8px] font-bold border shrink-0 ${r.color}`,children:n==="en"?r.en:r.bn})]})})]})}),e.jsx("td",{className:"hidden sm:table-cell px-3 sm:px-4 py-2",children:r&&e.jsx("span",{className:`inline-flex px-1.5 py-0.5 rounded text-[10px] font-bold border ${r.color}`,children:n==="en"?r.en:r.bn})}),e.jsx("td",{className:"px-3 sm:px-4 py-2 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:`text-xs font-black tabular-nums ${a?"text-blue-600 dark:text-blue-400":"text-slate-700 dark:text-slate-200"}`,children:t.points.toLocaleString()}),(((y=t.completed_lessons)==null?void 0:y.length)||0)>0&&e.jsxs("span",{className:"text-[8px] font-bold text-orange-500 flex items-center gap-0.5 leading-tight",children:[e.jsx("span",{children:"ðŸ“–"}),(t.completed_lessons.length*20).toLocaleString()]})]})})]}),x&&e.jsx("tr",{className:`${a?"bg-blue-50/50 dark:bg-blue-900/5":"bg-slate-50/50 dark:bg-slate-700/10"}`,children:e.jsx("td",{colSpan:"4",className:"px-4 sm:px-6 py-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-6 text-[10px] text-slate-600 dark:text-slate-400 animate-fade-in py-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"font-bold",children:n==="en"?"District:":"à¦œà§‡à¦²à¦¾:"}),e.jsx("span",{children:t.district||(n==="en"?"West Bengal":"à¦ªà¦¶à§à¦šà¦¿à¦®à¦¬à¦™à§à¦—")})]}),t.total_penalties>0&&e.jsxs("div",{className:"flex items-center gap-1.5 text-red-500 dark:text-red-400 font-bold",children:[e.jsx("span",{className:"text-xs",children:"ðŸ”¥"}),e.jsx("span",{children:n==="en"?"Total Points Lost:":"à¦®à§‹à¦Ÿ à¦ªà§Ÿà§‡à¦¨à§à¦Ÿ à¦¹à¦¾à¦°à¦¾à¦¨à§‹:"}),e.jsx("span",{children:t.total_penalties.toLocaleString()})]})]})})})]},s)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 sm:px-6 py-12 text-center",children:e.jsxs("div",{className:"text-slate-400",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ†"}),e.jsx("p",{className:"font-medium",children:n==="en"?"No rankings yet":"à¦à¦–à¦¨à¦“ à¦•à§‹à¦¨à§‹ à¦°â€à§à¦¯à¦¾à¦™à§à¦•à¦¿à¦‚ à¦¨à§‡à¦‡"})]})})})})]})})}),e.jsx("div",{className:"h-12 sm:h-16"})]})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12",children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-slate-900 dark:text-slate-100 tracking-tight",children:m.title})}),e.jsxs("div",{className:"flex items-center gap-2",children:[H>0&&e.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 rounded-2xl bg-red-50 text-red-700 border border-red-100 font-bold text-sm animate-fade-in shadow-sm",children:[e.jsx("span",{className:"text-lg",children:"ðŸ”¥"}),e.jsx("span",{className:"hidden xs:inline",children:n==="en"?"Last Loss:":"à¦¶à§‡à¦· à¦¹à¦¾à¦°à¦¾à¦¨à§‹:"}),e.jsxs("span",{children:["-",H]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-4 py-2 rounded-2xl bg-blue-50 text-blue-700 border border-blue-100 font-bold text-sm",children:[e.jsx("span",{className:"text-lg",children:"ðŸ†"}),n==="en"?"Competition Mode":"à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾ à¦®à§‹à¦¡"]})]})]}),e.jsx("div",{className:"max-w-md mx-auto mb-12",children:$?e.jsx(Ye,{}):h?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 border border-blue-200 dark:border-blue-800 shadow-sm text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 dark:text-slate-100 mb-6 tracking-tight",children:["5 ",n==="en"?"Quizzes Every Hour!":"à¦•à§à¦‡à¦œ à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦¨à§à¦Ÿà¦¾à¦¯à¦¼!"]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 text-xs text-slate-500 dark:text-slate-400",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-xl mb-1",children:"ðŸ“"}),e.jsxs("span",{className:"font-bold",children:["5 ",m.questions]})]}),e.jsx("div",{className:"w-px h-8 bg-slate-100 dark:bg-slate-700"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-xl mb-1",children:"ðŸ’Ž"}),e.jsxs("span",{className:"font-bold",children:["50 ",m.points]})]})]})]}),(ee||C)&&e.jsx("div",{className:`mb-3 p-3 rounded-lg border ${j==="success"?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":j==="failed"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":j==="waiting"?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ee&&e.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600 dark:text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-xs font-medium ${j==="success"?"text-green-700 dark:text-green-300":j==="failed"?"text-red-700 dark:text-red-300":j==="waiting"?"text-yellow-700 dark:text-yellow-300":"text-blue-700 dark:text-blue-300"}`,children:j==="syncing"?m.syncing:j==="waiting"?m.waitingNetwork:j==="success"?m.syncSuccess:j==="failed"?m.syncFailed:m.syncing}),te&&j==="failed"&&e.jsxs("div",{className:"text-[9px] text-red-500/80 dark:text-red-400/80 mt-0.5 font-medium max-w-[150px] truncate",title:te,children:["Error: ",te]}),j==="waiting"&&e.jsx("div",{className:"text-[10px] text-yellow-600 dark:text-yellow-400 mt-0.5",children:m.autoRetry})]})]}),j==="failed"&&!ee&&e.jsx("button",{onClick:ne,className:"px-3 py-1 text-xs font-medium text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/40 rounded transition-colors",children:m.retryNow})]})}),(()=>{if(!me)return e.jsxs("button",{onClick:()=>ye(h),disabled:C&&C.quiz_id===h.id,className:`w-full py-3 ${C&&C.quiz_id===h.id?"bg-slate-300 dark:bg-slate-700 cursor-not-allowed text-slate-500 dark:text-slate-400":"bg-blue-600 hover:bg-blue-700 text-white"} font-bold rounded-lg transition-colors flex items-center justify-center gap-2`,children:[e.jsx("span",{children:m.play}),e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]});const t=new Date(me),s=se();if(t.getFullYear()===s.getFullYear()&&t.getMonth()===s.getMonth()&&t.getDate()===s.getDate()&&t.getHours()===s.getHours()){const r=59-s.getMinutes(),l=59-s.getSeconds(),x=`${r}:${l<10?"0":""}${l}`;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"flex items-end justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1",children:"Next Quiz In"}),e.jsx("div",{className:"flex items-baseline gap-3",children:e.jsx("div",{className:"text-2xl font-mono font-bold text-slate-700 dark:text-slate-300",children:x})})]})})}),e.jsxs("button",{onClick:_e,className:"w-full py-3 rounded-lg font-bold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-all text-sm flex items-center justify-center gap-2",children:[e.jsx("span",{children:"Review Last Attempt"}),e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})]})]})}return e.jsxs("div",{className:"space-y-3",children:[H>0&&e.jsx("div",{className:"text-center mb-1",children:e.jsxs("span",{className:"text-[10px] font-bold text-red-600 dark:text-red-400 uppercase tracking-tight bg-red-50 dark:bg-red-900/20 px-2 py-0.5 rounded border border-red-100 dark:border-red-900/30",children:["Last Penalty: -",H," Points"]})}),e.jsxs("button",{onClick:()=>ye(h),className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{children:m.play}),e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),e.jsx("button",{onClick:_e,className:"w-full py-2 rounded-lg font-bold text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 transition-all text-xs",children:"Review Last Attempt"})]})})()]}):e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-8 border-2 border-dashed border-slate-200 dark:border-slate-700 text-center shadow-sm animate-fade-in",children:[e.jsxs("div",{className:"w-20 h-20 mx-auto mb-6 bg-slate-50 dark:bg-slate-900/50 rounded-full flex items-center justify-center relative",children:[e.jsx("span",{className:"text-4xl",children:"ðŸ“¡"}),!A&&e.jsx("div",{className:"absolute top-0 right-0 w-6 h-6 bg-red-500 rounded-full border-4 border-white dark:border-slate-800 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] text-white font-bold",children:"!"})})]}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 mb-3",children:n==="en"?"Connection Lost":"à¦¸à¦‚à¦¯à§‹à¦— à¦¬à¦¿à¦šà§à¦›à¦¿à¦¨à§à¦¨ à¦¹à¦¯à¦¼à§‡à¦›à§‡"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mb-8 max-w-xs mx-auto leading-relaxed",children:n==="en"?"We can't reach the safety servers right now. Don't worry, we'll automatically reconnect when you're back online.":"à¦†à¦®à¦°à¦¾ à¦à¦‡ à¦®à§à¦¹à§‚à¦°à§à¦¤à§‡ à¦¸à¦¾à¦°à§à¦­à¦¾à¦°à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦›à¦¿ à¦¨à¦¾à¥¤ à¦šà¦¿à¦¨à§à¦¤à¦¾ à¦•à¦°à¦¬à§‡à¦¨ à¦¨à¦¾, à¦‡à¦¨à§à¦Ÿà¦¾à¦°à¦¨à§‡à¦Ÿ à¦«à¦¿à¦°à§‡ à¦à¦²à§‡ à¦†à¦®à¦°à¦¾ à¦¸à§à¦¬à¦¯à¦¼à¦‚à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à¦¬à¥¤"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>re(),disabled:$,className:`w-full py-3 px-6 rounded-xl font-bold transition-all flex items-center justify-center gap-2 ${$?"bg-slate-100 dark:bg-slate-700 text-slate-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-500/20 active:scale-95"}`,children:$?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-slate-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:n==="en"?"Checking...":"à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:n==="en"?"Try Again Now":"à¦à¦–à¦¨à¦‡ à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-blue-500"})]}),n==="en"?"Auto-refresh active":"à¦¸à§à¦¬à¦¯à¦¼à¦‚à¦•à§à¦°à¦¿à¦¯à¦¼ à¦°à¦¿à¦«à§à¦°à§‡à¦¶ à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼"]})]})]})}),e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("h3",{className:"text-center font-bold text-slate-800 dark:text-slate-200 mb-6 flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"ðŸ…"})," ",m.leaderboard]}),i&&p&&!$&&e.jsx("div",{className:"bg-white dark:bg-slate-800/80 rounded-xl border border-slate-200 dark:border-slate-700 shadow-md p-3 sm:p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:n==="en"?"Your Standing":"à¦†à¦ªà¦¨à¦¾à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("p",{className:"text-xl sm:text-2xl font-black text-slate-900 dark:text-white",children:["#",p.rank]}),S((d==null?void 0:d.training_level)||0)&&e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-md text-[10px] font-bold border shadow-sm ${S((d==null?void 0:d.training_level)||0).color}`,children:n==="en"?S((d==null?void 0:d.training_level)||0).en:S((d==null?void 0:d.training_level)||0).bn}),e.jsxs("p",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 ml-1",children:[p.score.toLocaleString()," pts"]})]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center font-bold text-blue-600 dark:text-blue-300 border border-slate-200 dark:border-slate-600 overflow-hidden shrink-0",children:d!=null&&d.avatar_url?e.jsx("img",{src:d.avatar_url,alt:"Avatar",className:"w-full h-full object-cover"}):((Se=d==null?void 0:d.full_name)==null?void 0:Se[0])||"U"})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden divide-y divide-slate-100 dark:divide-slate-700",children:$?e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsx(E,{}),e.jsx(E,{}),e.jsx(E,{}),e.jsx(E,{})]}):i?e.jsxs(e.Fragment,{children:[(je?(()=>{const s=z.slice(0,3),a=z.findIndex(l=>l.user_id===(i==null?void 0:i.id));if(a===-1||a<3)return s;const r={...z[a],actualIndex:a};return[...s,r]})():z).map((s,a)=>{var b,o;const r=s.user_id===(i==null?void 0:i.id),l=s.actualIndex!==void 0?s.actualIndex:a,x=je&&a===3;return e.jsxs(ze.Fragment,{children:[x&&e.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-100 via-slate-50 to-slate-100 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx("div",{className:"h-px flex-1 bg-slate-300 dark:bg-slate-600"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Your Position"}),e.jsx("div",{className:"h-px flex-1 bg-slate-300 dark:bg-slate-600"})]})}),e.jsxs("div",{className:`flex items-center p-2 sm:p-3 transition-colors ${r?"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500":"hover:bg-slate-50 dark:hover:bg-slate-900/50"}`,children:[e.jsxs("div",{className:`font-bold w-5 text-xs ${l<3?"text-yellow-500":"text-slate-300"}`,children:["#",l+1]}),e.jsx("div",{className:"flex-shrink-0 mr-2",children:e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-[10px] font-bold text-slate-600 dark:text-slate-400 overflow-hidden",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"",className:"w-full h-full object-cover"}):((b=s.full_name)==null?void 0:b[0])||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("p",{className:"text-sm font-bold text-slate-900 dark:text-slate-100 truncate",children:[s.full_name||"Anonymous"," ",r&&"(You)"]}),s.training_level>0&&e.jsx("div",{className:`px-2 py-0.5 rounded-lg text-[9px] sm:text-[10px] font-bold border uppercase tracking-tight shrink-0 shadow-sm ${S(s.training_level).color}`,children:n==="en"?S(s.training_level).en:S(s.training_level).bn}),(((o=s.completed_lessons)==null?void 0:o.length)||0)>0&&e.jsxs("div",{className:"px-1.5 py-0.5 rounded-lg bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 border border-orange-100 dark:border-orange-800/50 text-[9px] font-bold shadow-sm",children:["ðŸ“– ",(s.completed_lessons.length*20).toLocaleString()]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 truncate mt-0.5",children:s.district||"West Bengal"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs sm:text-sm font-black text-blue-600 dark:text-blue-400",children:s.points}),e.jsx("div",{className:"text-[9px] text-slate-400 uppercase tracking-tighter",children:m.points})]})]})]},s.user_id||a)}),z.length===0&&e.jsx("div",{className:"p-8 text-center text-slate-400",children:P?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ“¡"}),e.jsx("p",{className:"text-sm font-medium",children:n==="en"?"Unable to load leaderboard. Please check your connection.":"à¦²à¦¿à¦¡à¦¾à¦°à¦¬à§‹à¦°à§à¦¡ à¦²à§‹à¦¡ à¦•à¦°à¦¾ à¦¸à¦®à§à¦­à¦¬ à¦¹à¦¯à¦¼à¦¨à¦¿à¥¤ à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦¨à§à¦Ÿà¦¾à¦°à¦¨à§‡à¦Ÿ à¦•à¦¾à¦¨à§‡à¦•à¦¶à¦¨ à¦šà§‡à¦• à¦•à¦°à§à¦¨à¥¤"}),e.jsx("button",{onClick:()=>Y(!0),className:"mt-2 text-xs text-blue-600 font-bold hover:underline",children:n==="en"?"Try Again":"à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨"})]}):n==="en"?"No participants yet. Be the first!":"à¦à¦–à¦¨à¦“ à¦•à§‡à¦‰ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦•à¦°à§‡à¦¨à¦¿à¥¤ à¦†à¦ªà¦¨à¦¿à¦‡ à¦ªà§à¦°à¦¥à¦® à¦¹à§‹à¦¨!"}),z.length>3&&e.jsx("div",{className:"p-3 text-center bg-white dark:bg-slate-800 border-t border-slate-100 dark:border-slate-700",children:e.jsxs("button",{onClick:Ne,className:"text-blue-600 dark:text-blue-400 font-bold hover:underline text-sm flex items-center gap-2 mx-auto",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),n==="en"?"View Full Leaderboard":"à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦²à¦¿à¦¡à¦¾à¦°à¦¬à§‹à¦°à§à¦¡ à¦¦à§‡à¦–à§à¦¨"]})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-300 mb-4 text-sm",children:n==="en"?"Login to view Leaderboard":"à¦²à¦¿à¦¡à¦¾à¦°à¦¬à§‹à¦°à§à¦¡ à¦¦à§‡à¦–à¦¤à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨"}),e.jsx("button",{onClick:()=>T("login"),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors text-xs",children:n==="en"?"Login Now":"à¦à¦–à¦¨à¦‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨"})]})}),i&&p&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-800 border-t border-slate-200 p-4 shadow-2xl transform transition-transform duration-300 z-40 sm:hidden",children:e.jsxs("div",{className:"flex items-center justify-between max-w-sm mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xl font-bold text-slate-400",children:["#",p.rank]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-bold text-slate-800 dark:text-slate-200",children:"You"}),e.jsxs("div",{className:"text-slate-500 text-xs",children:[p.score," pts"]})]})]}),e.jsx("button",{onClick:Ne,className:"text-blue-600 text-sm font-bold",children:"View All"})]})})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl w-full max-w-2xl p-6 sm:p-8 max-h-[90vh] overflow-y-auto border border-slate-200 dark:border-slate-700",children:Ee?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 rounded-full flex items-center justify-center text-4xl mx-auto mb-6",children:"ðŸŽ‰"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:m.completed}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-8 mt-4",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/10 p-3 rounded-xl border border-green-100 dark:border-green-900/30",children:[e.jsx("div",{className:"text-[10px] font-bold text-green-600 uppercase tracking-tighter mb-1",children:"Right"}),e.jsxs("div",{className:"text-xl font-bold text-green-700 dark:text-green-400",children:["+",(v==null?void 0:v.pointsEarned)||0]})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 p-3 rounded-xl border border-red-100 dark:border-red-900/30",children:[e.jsx("div",{className:"text-[10px] font-bold text-red-600 uppercase tracking-tighter mb-1",children:"Wrong"}),e.jsxs("div",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:["-",(v==null?void 0:v.penalty)||0]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/10 p-3 rounded-xl border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-tighter mb-1",children:"Skipped"}),e.jsx("div",{className:"text-xl font-bold text-slate-600 dark:text-slate-400",children:(v==null?void 0:v.skipped)||0})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 p-3 rounded-xl border border-blue-100 dark:border-blue-900/30",children:[e.jsx("div",{className:"text-[10px] font-bold text-blue-600 uppercase tracking-tighter mb-1",children:"Net"}),e.jsx("div",{className:"text-xl font-bold text-blue-700 dark:text-blue-400",children:(v==null?void 0:v.score)||0})]})]}),p&&((d==null?void 0:d.points)||(p==null?void 0:p.score))>1e3&&e.jsxs("div",{className:"mb-6 inline-flex items-center gap-1.5 px-3 py-1 rounded-lg bg-amber-50 dark:bg-amber-900/10 text-amber-600 dark:text-amber-400 text-[10px] font-bold border border-amber-100 dark:border-amber-900/30",children:[e.jsx("span",{children:"âš ï¸"})," ",m.highStakesDesc]}),e.jsx("button",{onClick:()=>{M(null),W(!1)},className:"w-full py-3 bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 rounded-lg font-bold hover:bg-slate-800 dark:hover:bg-white transition-colors",children:m.close})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:f.title}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"text-xs text-slate-500",children:[m.questions," ",k+1," / ",u.length]}),p&&p.score>1e3&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded-full bg-amber-50 dark:bg-amber-900/20 border border-amber-100 dark:border-amber-800 animate-pulse",children:[e.jsx("span",{className:"text-[10px]",children:"ðŸ”¥"}),e.jsx("span",{className:"text-[10px] font-bold text-amber-700 dark:text-amber-400 uppercase tracking-wider",children:m.highStakes})]})]})]}),e.jsx("button",{onClick:()=>M(null),className:"w-8 h-8 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-700 h-1.5 rounded-full mb-6",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${(k+1)/u.length*100}%`}})}),e.jsx("h2",{className:`reading-content text-lg sm:text-xl font-bold mb-6 ${n==="bn"?"font-bengali":""}`,children:(Le=u[k])==null?void 0:Le.question_text}),e.jsx("div",{className:"space-y-2.5",children:($e=(Ce=u[k])==null?void 0:Ce.options)==null?void 0:$e.map((t,s)=>{const a=w[u[k].id]===s,r=s===u[k].correct_option_index;let l="border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700 hover:bg-slate-50 dark:hover:bg-slate-900/50 text-slate-600 dark:text-slate-400";return L?r?l="border-green-500 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 font-bold":a&&!r?l="border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":l="border-slate-100 dark:border-slate-800 opacity-60":a&&(l="border-blue-600 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 font-bold"),e.jsxs("button",{onClick:()=>!L&&Be(u[k].id,s),disabled:L,className:`w-full text-left p-3.5 rounded-lg border transition-all duration-200 ${l}`,children:[e.jsxs("span",{className:"mr-3 text-slate-400 font-mono",children:[String.fromCharCode(65+s),"."]}),e.jsx("span",{className:`reading-content text-sm sm:text-base ${n==="bn"?"font-bengali":""}`,children:t}),L&&r&&e.jsx("span",{className:"float-right text-green-600",children:"âœ“"}),L&&a&&!r&&e.jsx("span",{className:"float-right text-red-600",children:"âœ—"})]},s)})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-slate-100 dark:border-slate-700",children:[e.jsx("button",{disabled:k===0,onClick:()=>R(t=>t-1),className:"text-slate-500 hover:text-slate-800 dark:text-slate-200 font-bold text-sm disabled:opacity-30 px-4",children:"â† Prev"}),k===u.length-1?e.jsx("button",{onClick:L?()=>M(null):Ue,className:`px-6 py-2.5 rounded-lg font-bold text-sm transition-colors ${L?"bg-slate-800 dark:bg-slate-700 text-white hover:bg-slate-900 dark:hover:bg-slate-600":"bg-green-600 text-white hover:bg-green-700"}`,children:L?"Close Review":"Finish Quiz"}):e.jsx("button",{onClick:()=>R(t=>t+1),className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg font-bold text-sm hover:bg-blue-700 transition-colors",children:"Next â†’"})]})]})})})]})}const Ye=()=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-100 dark:border-slate-700 shadow-sm relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-100 dark:bg-slate-700 rounded-lg shimmer"}),e.jsx("div",{className:"h-6 w-32 bg-slate-100 dark:bg-slate-700 rounded shimmer"})]}),e.jsx("div",{className:"h-8 w-3/4 bg-slate-100 dark:bg-slate-700 rounded mb-6 shimmer"}),e.jsxs("div",{className:"flex justify-center gap-8 mb-8",children:[e.jsx("div",{className:"h-4 w-16 bg-slate-100 dark:bg-slate-700 rounded shimmer"}),e.jsx("div",{className:"h-4 w-16 bg-slate-100 dark:bg-slate-700 rounded shimmer"})]}),e.jsx("div",{className:"h-12 w-full bg-slate-100 dark:bg-slate-700 rounded-lg shimmer"})]}),E=()=>e.jsxs("div",{className:"flex items-center p-4 border-b border-slate-50 dark:border-slate-700 last:border-0",children:[e.jsx("div",{className:"w-6 h-4 bg-slate-100 dark:bg-slate-700 rounded shimmer mr-4"}),e.jsx("div",{className:"w-10 h-10 bg-slate-100 dark:bg-slate-700 rounded-full shimmer mr-4"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 bg-slate-100 dark:bg-slate-700 rounded shimmer"}),e.jsx("div",{className:"h-3 w-20 bg-slate-100 dark:bg-slate-700 rounded shimmer"})]}),e.jsx("div",{className:"h-6 w-12 bg-slate-100 dark:bg-slate-700 rounded shimmer"})]});export{Pe as default};
