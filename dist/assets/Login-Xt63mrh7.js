import{r as a,j as r,s as n}from"./index-CAdTqaS5.js";function N({onLogin:w,showNotification:d}){const[u,c]=a.useState(!1),[i,x]=a.useState(""),[o,k]=a.useState(""),[p,y]=a.useState(""),[e,l]=a.useState("login"),[g,b]=a.useState(null);a.useEffect(()=>{(window.location.hash.includes("type=recovery")||window.location.href.includes("type=recovery"))&&l("update")},[]);const v=async s=>{s.preventDefault(),c(!0),b(null);try{if(e==="signup"){const{error:t}=await n.auth.signUp({email:i,password:o});if(t)throw t;d("Check your email for the login link!")}else if(e==="login"){const{data:t,error:f}=await n.auth.signInWithPassword({email:i,password:o});if(f)throw f;if(t.user){const m=crypto.randomUUID(),{error:h}=await n.from("profiles").update({current_session_id:m}).eq("id",t.user.id);h&&console.error("Error updating session ID:",h),localStorage.setItem("slm_session_id",m),w(t.user)}}else if(e==="forgot"){const{error:t}=await n.auth.resetPasswordForEmail(i,{redirectTo:`${window.location.origin}${window.location.pathname}#/login`});if(t)throw t;d("Password reset link sent to your email!"),l("login")}else if(e==="update"){if(o!==p)throw new Error("Passwords do not match");const{error:t}=await n.auth.updateUser({password:o});if(t)throw t;d("Password updated successfully! You can now sign in."),l("login")}}catch(t){b(t.message),d(t.message,"error")}finally{c(!1)}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900 px-4 py-8",children:r.jsx("div",{className:"w-full max-w-sm",children:r.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 p-8",children:[r.jsx("div",{className:"mb-6",children:r.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:e==="signup"?"Create Account":e==="forgot"?"Reset Password":e==="update"?"New Password":"Sign In"})}),g&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg border border-red-200 dark:border-red-800",children:g}),r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[(e==="login"||e==="signup"||e==="forgot")&&r.jsx("input",{type:"email",required:!0,value:i,onChange:s=>x(s.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-900 dark:text-slate-100 placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Email address"}),(e==="login"||e==="signup"||e==="update")&&r.jsxs("div",{children:[r.jsx("input",{type:"password",required:!0,value:o,onChange:s=>k(s.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-900 dark:text-slate-100 placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e==="update"?"New password":"Password"}),e==="login"&&r.jsx("button",{type:"button",onClick:()=>l("forgot"),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline mt-2 inline-block",children:"Forgot password?"})]}),e==="update"&&r.jsx("input",{type:"password",required:!0,value:p,onChange:s=>y(s.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-900 dark:text-slate-100 placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Confirm password"}),r.jsx("button",{type:"submit",disabled:u,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:u?r.jsx("span",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e==="signup"?"Create Account":e==="forgot"?"Send Reset Link":e==="update"?"Update Password":"Sign In"})]}),r.jsxs("div",{className:"mt-6 text-center text-sm text-slate-600 dark:text-slate-400",children:[e==="signup"?"Already have an account?":e==="forgot"||e==="update"?"Remember your password?":"Don't have an account?"," ",r.jsx("button",{onClick:()=>l(e==="signup"||e==="forgot"||e==="update"?"login":"signup"),className:"text-blue-600 dark:text-blue-400 font-semibold hover:underline",children:e==="signup"||e==="forgot"||e==="update"?"Sign In":"Sign Up"})]})]})})})}export{N as default};
